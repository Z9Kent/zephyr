# Z9 Security z9io Protocol Enumerated Values and Data Structures

![Z9 Security](z9security.png)

_Copyright &copy; 2015-2024 Z9 Security.
Use of this documentation requires both an active non-disclosure agreement, as well as an active software redistribution agreement, with Z9 Security,
and is subject to the terms of those agreements. Any other use, or disclosure, of this documentation is prohibited._

# Enumerated Values and Data Structures

## `HostPairingState` Enumeration Values

Pairing state for HostStatus

| Ordinal | Value          | Description
| ------- | -------------- | -----------
| 0       | `CONSTRUCTION` | Construction mode
| 1       | `PAIRING`      | Pairing mode.
| 2       | `PAIRED`       | Paired ("Customer mode")

## `ProtocolPassthruId` Enumeration Values

Protocol passthru ID for ProtocolPassthru packet.

| Ordinal | Value            | Description
| ------- | ---------------- | -----------
| 0       | `NONE`           | None.
| 1       | `Z9LOCKIO`       | z9lockio.
| 2       | `SECURE_ELEMENT` | Secure element.

## `EncryptionKeyExchangeType` Enumeration Values

Indicates the semantics of the EncryptionKeyExchange message.

| Ordinal | Value                    | Description
| ------- | ------------------------ | -----------
| 0       | `LINKING_SEED_REQ`       | Link-layer encryption: Linking seed request.  Sent by upstream device.  Sent only if never linked, or after factory reset.  bytes sent is random seed generated by sender, and is 16 bytes.
| 1       | `LINKING_SEED_RESP`      | Link-layer encryption: Linking seed response.  Sent by downstream device in response to LINKING_SEED_REQ.  bytes sent is random seed generated by sender, and is 16 bytes.  The base linking seed will be the bitwise XOR of both seeds.
| 2       | `LINK_SESSION_SEED_REQ`  | Link-layer encryption: Session seed request.  Sent by upstream device.  bytes sent is random seed generated by sender, and is 16 bytes.
| 3       | `LINK_SESSION_SEED_RESP` | Link-layer encryption: Session seed response. Sent by downstream device in response to SESSION_SEED_REQ.  bytes sent is random seed generated by sender, and is 16 bytes.  The actual AES session key will be the bitwise XOR of the base linking seed, the session seed req bytes, and the session seed resp bytes.

## `ApplicationEncryptionKeyExchangeType` Enumeration Values

Indicates the semantics of the ApplicationEncryptionKeyExchange message.

| Ordinal | Value                      | Description
| ------- | -------------------------- | -----------
| 0       | `PUBLIC_KEY_REQ`           | Cloud-lock encryption: Request for (lock) EC public key.  Sent by upstream device.  Bytes is empty.
| 1       | `PUBLIC_KEY_RESP`          | Cloud-lock encryption: Response with (lock) EC public key.  Sent by downstream device in response to PUBLIC_KEY_REQ.  Bytes is 65 bytes encoded EC public key.
| 2       | `KEY_AGREEMENT_REQ`        | Cloud-lock encryption: request for key agreement.  Sent by upstream device.  bytes sent is the cloud EC public key, 65 bytes.
| 3       | `KEY_AGREEMENT_RESP`       | Cloud-lock encryption: response with key agreement using lock public key and cloud public key.  Sent by downstream device in response to KEY_AGREEMENT_REQ.  bytes sent is agreed key (ECDH), 16 bytes.
| 4       | `BLE_CHALLENGE_NONCE_REQ`  | Mobile-lock encryption: Request for nonce that will be used to challenge the mobile device over BLE.  Sent by downstream device to upstream device.  Upstream device generates nonce.  Request bytes sent is 0 bytes.
| 5       | `BLE_CHALLENGE_NONCE_RESP` | Mobile-lock encryption: Response to BLE_CHALLENGE_NONCE_REQ.  Generated by upstream device, and sent by upstream device to downstream device.  Response bytes sent is nonce, 16 bytes.

## `PacketContent` Data Structure


| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `contentType`                              | byte                               | 
| variable                         |                                            |                                    | discriminator-specific content

## `RawRead` Data Structure

Raw credential/card read.  Contains card bits in the style of a Wiegand card read.  Note: Wiegand card readers output their key presses as Wiegand, so the key presses can also come across as a RawRead, typically with whatever 4-bit or 8-bit keypad format the reader uses.

Maximum serialized length: 36 bytes
`PacketContent` discriminator: byte: 1

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand or other input index), starting at 0
| 1 byte                           | `trimBitsInLastByte`                       | byte                               | Number of bits to trim in last byte of card data.  So for example for 26-bit Wiegand, this would be 6, because 32-6=26.
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field - Number of bytes of card data that follow, maximum 32
| Up to 32 elements (32 bytes)     | `bytes`                                    | byte                               | Card data bytes.

## `RawKey` Data Structure

Single raw keypad key press.

Maximum serialized length: 3 bytes
`PacketContent` discriminator: byte: 19

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `keypadIndex`                              | byte                               | Keypad index (or reader index), starting at 0.
| 1 byte                           | `key`                                      | byte                               | Key's ASCII code.

## `DigitalRead` Data Structure

Digital read - Initial, or change, in digital input value.

Maximum serialized length: 4 bytes
`PacketContent` discriminator: byte: 4

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `inputIndex`                               | byte                               | Digital input index, starting at 0.
| 1 byte                           | `value`                                    | boolean                            | Raw value (0 for off, 1 for on).
| 1 byte                           | `active`                                   | boolean                            | Interpreted value (same as raw value, unless DigitalInConfig was sent with invert=true, in which case it is the opposite).

## `TemperatureRead` Data Structure

Temperature/humidity read.

Maximum serialized length: 18 bytes
`PacketContent` discriminator: byte: 5

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `deviceIndex`                              | byte                               | Device index.  0 for the first device, 1 for the second, etc.
| 8 elements elements (8 bytes)    | `deviceAddress`                            | byte                               | Device address.  8 bytes.
| 4 bytes                          | `tempC`                                    | Single-precision floating point    | Temperature in degrees C.
| 4 bytes                          | `humidity`                                 | Single-precision floating point    | Humidity in percent.

## `BoardInfo` Data Structure

Board information.  Sent from Sub-Controller to Intelligent Controller, in response to Hello.

Maximum serialized length: 34 bytes
`PacketContent` discriminator: byte: 7

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `protocolVersionMajor`                     | byte                               | Protocol version (major) - as a binary number
| 1 byte                           | `protocolVersionMinor`                     | byte                               | Protocol version (minor) - as a binary number
| 2 bytes                          | `model`                                    | 16-bit integer                     | Board model number
| 1 byte                           | `firmwareVersionMajor`                     | byte                               | Firmware version (major) - as a binary number
| 1 byte                           | `firmwareVersionMinor`                     | byte                               | Firmware version (minor) - as a binary number
| 1 byte                           | `encryptionEnabled`                        | boolean                            | true if encryption is enabled (the key has been negotiated).  Note that BoardInfo messages are not encrypted.
| 8 bytes                          | `serialNumber`                             | 64-bit integer                     | 8-byte serial number of the sender, used for key diversification if encryption is enabled.
| 1 byte                           | `spare`                                    | byte                               | Unused. Set to 0.
| 2 bytes                          | `webServerPort`                            | 16-bit integer                     | RFU. Set to 0.
| 2 bytes                          | `protocolServerPort`                       | 16-bit integer                     | RFU. Set to 0.
| 1 byte                           | `mega`                                     | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableSD`                                 | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableEthernet`                           | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableSystemLED`                          | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableDigitalIn`                          | boolean                            | Digital input(s) enabled/available: 0 (false) or 1 (true)
| 1 byte                           | `enableDigitalOut`                         | boolean                            | Digital output(s) enabled/available: 0 (false) or 1 (true)
| 1 byte                           | `enableAnalogIn`                           | boolean                            | Analog input(s) enabled/available: 0 (false) or 1 (true)
| 1 byte                           | `enableData01`                             | boolean                            | Wiegand input(s) enabled/available: 0 (false) or 1 (true)
| 1 byte                           | `enableRfid`                               | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableLCD`                                | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableKeypad`                             | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableDallasTemperature`                  | boolean                            | RFU. Set to 0.
| 1 byte                           | `enableSHTXTemperature`                    | boolean                            | RFU. Set to 0.

## `AnalogRead` Data Structure

Analog read - Initial, or change, in analog input value.

Maximum serialized length: 5 bytes
`PacketContent` discriminator: byte: 9

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `inputIndex`                               | byte                               | Analog input index, starting at 0.
| 2 bytes                          | `value`                                    | 16-bit integer                     | Analog value as a 16-bit value.
| 1 byte                           | `active`                                   | byte                               | Value interpretation: 0-4, where 0=INACTIVE, 1=ACTIVE, 2=SHORT, 3=CUT, 4=OUT_OF_RANGE

## `FileContents` Data Structure

File contents.  In response to FileQuery.

Maximum serialized length: 1034 bytes
`PacketContent` discriminator: byte: 12

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `fileId`                                   | byte                               | File ID - 0: None, 1: Software/firmware update
| 4 bytes                          | `offset`                                   | 32-bit integer                     | 32-bit offset of data provided within file - must match offset requested in FileQuery.
| 1 byte                           | `eof`                                      | boolean                            | True for end of file.  Note that if eof=true, bytes may be provided, in which case it means that the end of file is immediately after the bytes being provided.
| 1 byte                           | `exception`                                | byte                               | 0 for no exception, nonzero for any kind of error accessing or providing the file.
| 2 bytes                          | `numBytes`                                 | 16-bit integer                     | element count of next field - The number of bytes (16-bit value).
| Up to 1024 elements (1024 bytes) | `bytes`                                    | byte                               | Requested file bytes.

## `BoardStatus` Data Structure

Board status.  In response to BoardStatusQuery.

Maximum serialized length: 55 bytes
`PacketContent` discriminator: byte: 14

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 4 bytes                          | `millis`                                   | 32-bit integer                     | Milliseconds since startup.
| 2 bytes                          | `memoryAvailable`                          | 16-bit integer                     | Available memory in bytes.
| 1 byte                           | `helloReceived`                            | boolean                            | `Hello` received (0 for false, 1 for true)
| 1 byte                           | `protocolConnectionType`                   | byte                               | Protocol connection type - 0 for none, 1 for serial, 2 for network
| 4 bytes                          | `numSerialProtocolPacketsRead`             | 32-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numSerialProtocolPacketsWritten`          | 32-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numNetworkProtocolPacketsRead`            | 32-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numNetworkProtocolPacketsWritten`         | 32-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numSerialProtocolInputErrors`             | 32-bit integer                     | RFU (set to 0)
| 2 bytes                          | `lastSerialProtocolInputError`             | 16-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numSerialProtocolOutputErrors`            | 32-bit integer                     | RFU (set to 0)
| 2 bytes                          | `lastSerialProtocolOutputError`            | 16-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numNetworkProtocolInputErrors`            | 32-bit integer                     | RFU (set to 0)
| 2 bytes                          | `lastNetworkProtocolInputError`            | 16-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numNetworkProtocolOutputErrors`           | 32-bit integer                     | RFU (set to 0)
| 2 bytes                          | `lastNetworkProtocolOutputError`           | 16-bit integer                     | RFU (set to 0)
| 4 bytes                          | `numSdErrors`                              | 32-bit integer                     | RFU (set to 0)
| 2 bytes                          | `lastSdError`                              | 16-bit integer                     | RFU (set to 0)

## `Pong` Data Structure

Pong - response to a Ping.

Maximum serialized length: 1 bytes
`PacketContent` discriminator: byte: 16

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------

## `Ack` Data Structure

Ack - positive response to any message

Maximum serialized length: 3 bytes
`PacketContent` discriminator: byte: 21

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `spare`                                    | byte                               | RFU
| 1 byte                           | `responseToSeqno`                          | byte                               | Sequence number of packet being acknowledged.

## `Nak` Data Structure

Nak - negative response to any message

Maximum serialized length: 4 bytes
`PacketContent` discriminator: byte: 22

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `spare`                                    | byte                               | RFU
| 1 byte                           | `responseToSeqno`                          | byte                               | Sequence number of packet being negatively acknowledged.
| 1 byte                           | `reason`                                   | byte                               | Reason code for nak (rejection).  The reason code is sub-controller implementation-specific.  There are no predefined reason codes.

## `BioVerified` Data Structure

Biometric has been verified.

Maximum serialized length: 42 bytes
`PacketContent` discriminator: byte: 23

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand or other input index), starting at 0
| 1 byte                           | `bioTechnology`                            | byte                               | Biometric technology.  0: Generic, 1: Fingerprint, 2: Face, 3: Voice, 4: Iris, 5: Retina, 6: Hand geometry, 7: Finger vein.
| 1 byte                           | `verified`                                 | boolean                            | 0 for verification failed, 1 for verification succeeded.
| 1 byte                           | `numUserIdChars`                           | byte                               | element count of next field - Number of bytes of user ID data that follow, maximum 32.
| Up to 32 elements (32 bytes)     | `userIdChars`                              | byte                               | User ID data bytes.  Each byte is an ASCII value.  If the User ID is a number, then this is an ASCII string representing the number.
| 1 byte                           | `credUnidPresent`                          | boolean                            | 0 for credential unid absent, 1 for credential unid present.  Note that either user ID must be specified, or credential unid present.  If both are specified, credential unid takes precedence.
| 4 bytes                          | `credUnid`                                 | 32-bit integer                     | if credUnidPresent is true, this is the unid of the Cred that has been verified.

## `RawKeys` Data Structure

Raw keypad keys (multiple).

Maximum serialized length: 35 bytes
`PacketContent` discriminator: byte: 24

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `keypadIndex`                              | byte                               | Keypad index (or reader index), starting at 0.
| 1 byte                           | `numKeys`                                  | byte                               | element count of next field - Number of bytes key data to follow, maximum 32.
| Up to 32 elements (32 bytes)     | `keys`                                     | byte                               | Key data bytes - each byte is the ASCII code of the key.

## `UserIdRead` Data Structure

User ID read.  Generally due to entering user ID on keypad.

Maximum serialized length: 35 bytes
`PacketContent` discriminator: byte: 25

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand or other input index), starting at 0
| 1 byte                           | `numUserIdChars`                           | byte                               | element count of next field - Number of bytes of user ID data that follow, maximum 32.
| Up to 32 elements (32 bytes)     | `userIdChars`                              | byte                               | User ID data bytes.  Each byte is an ASCII value.  If the User ID is a number, then this is an ASCII string representing the number.

## `BioRead` Data Structure

Biometric read.

Maximum serialized length: 2054 bytes
`PacketContent` discriminator: byte: 27

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | 
| 1 byte                           | `bioTechnology`                            | byte                               | Biometric technology.  0: Generic, 1: Fingerprint, 2: Face, 3: Voice, 4: Iris, 5: Retina, 6: Hand geometry, 7: Finger vein.
| 1 byte                           | `bioFormat`                                | byte                               | Biometric format.  0: Fingerprint: ZKTeco, 1: Fingerprint: ANSI 378, 2: Fingerprint: ISO 19794-2, 3: Face: ZKTeco.
| 2 bytes                          | `numBytes`                                 | 16-bit integer                     | element count of next field - Number of bytes of biometric data that follow (16-bit value), maximum 2048.
| Up to 2048 elements (2048 bytes) | `bytes`                                    | byte                               | Biometric data bytes.

## `ReaderStatus` Data Structure

Reader status - Comm, tamper, power status of a card reader.

Maximum serialized length: 5 bytes
`PacketContent` discriminator: byte: 28

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand or other input index), starting at 0
| 1 byte                           | `offline`                                  | boolean                            | true (1) if offline.
| 1 byte                           | `tamper`                                   | boolean                            | true (1) if tamper problem.
| 1 byte                           | `power`                                    | boolean                            | true (1) if power problem.

## `FileAvailable` Data Structure

Indicates that a file is available.  Generally for software (firmware) update files.  If the recipient is interested, they might then send FileQuery.

Maximum serialized length: 6 bytes
`PacketContent` discriminator: byte: 33

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `fileId`                                   | byte                               | File ID - 0: None, 1: Software/firmware update
| 4 bytes                          | `fileLength`                               | 32-bit integer                     | file length in bytes

## `ProcessFile` Data Structure

Indicates that a file is to be processed.  Generally for software (firmware) update files, in which case "processing" it means applying the software update, and generally restarting.

Maximum serialized length: 2 bytes
`PacketContent` discriminator: byte: 34

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `fileId`                                   | byte                               | File ID - 0: None, 1: Software/firmware update

## `Ping` Data Structure

Ping - periodic high-level check to ensure that the Sub-Controller is still responding to the Intelligent Controller.  Only relevant for multidrop=false.  Expected response: Pong.

Maximum serialized length: 1 bytes
`PacketContent` discriminator: byte: 15

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------

## `BoardStatusQuery` Data Structure

Board status query.  Expected response is BoardStatus.

Maximum serialized length: 1 bytes
`PacketContent` discriminator: byte: 13

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------

## `Config` Data Structure

High-level configuration, from the Intelligent Controller to the Sub-Controller.

Maximum serialized length: 18 bytes
`PacketContent` discriminator: byte: 10

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `enableSystemLED`                          | byte                               | RFU (set to 0).
| 4 bytes                          | `enableDigitalIn`                          | 32-bit integer                     | Bit mask of digital inputs to enable (bit 0 for input 0, etc.)
| 4 bytes                          | `enableDigitalOut`                         | 32-bit integer                     | Bit mask of digital outputs to enable (bit 0 for output 0, etc.)
| 2 bytes                          | `enableAnalogIn`                           | 16-bit integer                     | Bit mask of analog inputs to enable (bit 0 for input 0, etc.)
| 1 byte                           | `enableData01`                             | byte                               | Bit mask of Wiegand/card reader inputs to enable (bit 0 for input 0, etc.)
| 1 byte                           | `enableRfid`                               | byte                               | RFU (set to 0).
| 1 byte                           | `enableLCD`                                | byte                               | RFU (set to 0).
| 1 byte                           | `enableDallasTemperature`                  | byte                               | RFU (set to 0).
| 1 byte                           | `enableSHTXTemperature`                    | byte                               | RFU (set to 0).
| 1 byte                           | `enableKeypad`                             | byte                               | RFU (set to 0).

## `FileQuery` Data Structure

Request for the contents of a specific file.  Expected response: one FileContents.

Maximum serialized length: 6 bytes
`PacketContent` discriminator: byte: 11

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `fileId`                                   | byte                               | File ID - 0: None, 1: Software/firmware update
| 4 bytes                          | `offset`                                   | 32-bit integer                     | 32-bit offset requested.  0 for the beginning of the file, otherwise should generally be offset + numBytes from most recent FileContents.

## `Hello` Data Structure

Initial message sent from Intelligent Controller to Sub-Controller.  First message to establish connection.

Maximum serialized length: 5 bytes
`PacketContent` discriminator: byte: 8

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `protocolVersionMajor`                     | byte                               | Protocol version (major) - as a binary number.
| 1 byte                           | `protocolVersionMinor`                     | byte                               | Protocol version (minor) - as a binary number.
| 1 byte                           | `multidrop`                                | boolean                            | Multidrop enabled: 0 (false) or 1 (true)
| 1 byte                           | `encryptionEnabled`                        | boolean                            | true if encryption is enabled (the key has been negotiated).  Note that Hello messages themselves are not encrypted.

## `SerialWrite` Data Structure

Write arbitrary data to a serial port.

Maximum serialized length: 51 bytes
`PacketContent` discriminator: byte: 6

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `portIndex`                                | byte                               | Serial port index.  0 for the first port, 1 for the second, etc.
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field - Number of bytes to write.
| Up to 48 elements (48 bytes)     | `bytes`                                    | byte                               | Bytes to write.

## `DisplayWrite` Data Structure

Write to a text display (e.g. LCD display)

Maximum serialized length: 51 bytes
`PacketContent` discriminator: byte: 20

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `portIndex`                                | byte                               | 
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field
| Up to 48 elements (48 bytes)     | `bytes`                                    | byte                               | 

## `AnalogInConfig` Data Structure

Analog input configuration.  Analog inputs are often used for supervised inputs.

Maximum serialized length: 19 bytes
`PacketContent` discriminator: byte: 17

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `inputIndex`                               | byte                               | Input index (starting at 0)
| 1 byte                           | `enabled`                                  | boolean                            | Enabled (0 for false, 1 for true)
| 1 byte                           | `invert`                                   | boolean                            | Invert (0 for false, 1 for true).  If inverted, INACTIVE and ACTIVE are swapped in AnalogRead.
| 1 byte                           | `reportAllData`                            | boolean                            | RFU (set to 0)
| 2 bytes                          | `debounce`                                 | 16-bit integer                     | RFU (set to 0)
| 2 bytes                          | `loStart`                                  | 16-bit integer                     | low range start value
| 2 bytes                          | `loStop`                                   | 16-bit integer                     | low range stop value
| 2 bytes                          | `hiStart`                                  | 16-bit integer                     | high range start value
| 2 bytes                          | `hiStop`                                   | 16-bit integer                     | high range stop value
| 2 bytes                          | `tolerance`                                | 16-bit integer                     | RFU (set to 0)
| 2 bytes                          | `pollInterval`                             | 16-bit integer                     | RFU (set to 0)

## `DigitalInConfig` Data Structure

Digital input configuration.

Maximum serialized length: 8 bytes
`PacketContent` discriminator: byte: 18

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `inputIndex`                               | byte                               | Input index (starting at 0)
| 1 byte                           | `enabled`                                  | boolean                            | Enabled (0 for false, 1 for true)
| 1 byte                           | `invert`                                   | boolean                            | Invert (0 for false, 1 for true).  If inverted, active is the opposite of value in DigitalRead, otherwise they are the same.
| 1 byte                           | `reportAllData`                            | boolean                            | RFU (set to 0)
| 1 byte                           | `enablePullup`                             | boolean                            | RFU (set to 0)
| 2 bytes                          | `debounce`                                 | 16-bit integer                     | RFU (set to 0)

## `DigitalWrite` Data Structure

Digital write (output) - for example a relay output.

Maximum serialized length: 5 bytes
`PacketContent` discriminator: byte: 3

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `outputIndex`                              | byte                               | Digital output index, starting at 0.
| 1 byte                           | `value`                                    | byte                               | Value (0 for off, 1 for on).
| 2 bytes                          | `duration`                                 | 16-bit integer                     | 0 for indefinite/permanent, otherwise pulse duration: duration in milliseconds to pulse

## `RawWrite` Data Structure

Raw card/credential write, e.g. Wiegand (output).

Maximum serialized length: 36 bytes
`PacketContent` discriminator: byte: 2

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand output index), starting at 0.
| 1 byte                           | `trimBitsInLastByte`                       | byte                               | Number of bits to trim in last byte of card data.  So for example for 26-bit Wiegand, this would be 6, because 32-6=26.
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field - Number of bytes of card data that follow, maximum 32.
| Up to 32 elements (32 bytes)     | `bytes`                                    | byte                               | Card data bytes.

## `ReaderState` Data Structure

Set the state of an intelligent card reader.

Maximum serialized length: 51 bytes
`PacketContent` discriminator: byte: 26

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `readerIndex`                              | byte                               | Reader index (Wiegand or other input index), starting at 0
| 1 byte                           | `doorModeType`                             | byte                               | Door mode type: corresponds to z9.om.dev.types.DoorModeType enumeration.
| 1 byte                           | `stateType`                                | byte                               | State type: corresponds to z9.om.dev.CredReaderDisplayStateType enumeration.
| 4 bytes                          | `stateTypeSeqNo`                           | 32-bit integer                     | State type sequence number.  This value increments when and only when the same stateType happens "again", but the previous stateType and the new stateType are the same.
| 1 byte                           | `numUserIdChars`                           | byte                               | element count of next field - Number of bytes of user ID data that follow, maximum 32
| Up to 32 elements (32 bytes)     | `userIdChars`                              | byte                               | User ID data bytes.  Each byte is an ASCII value.  If the User ID is a number, then this is an ASCII string representing the number.
| 1 byte                           | `credUnidPresent`                          | boolean                            | 0 for credential unid absent, 1 for credential unid present.
| 4 bytes                          | `credUnid`                                 | 32-bit integer                     | if credUnidPresent is true, this is the unid of the Cred is being processed at the reader/door.
| 1 byte                           | `credHolderUnidPresent`                    | boolean                            | true if credHolderUnid value is present.  If false, credHolderUnid can be considered "null".
| 4 bytes                          | `credHolderUnid`                           | 32-bit integer                     | if credHolderUnidPresent is true, this is the unid of the CredHolder is being processed at the reader/door.

## `Poll` Data Structure

Maximum serialized length: 1 bytes
`PacketContent` discriminator: byte: 29

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------

## `HostInfo` Data Structure

Additional host information beyond "Hello", used by the control board side of a Z9 Lock, to the reader board.

Maximum serialized length: 13 bytes
`PacketContent` discriminator: byte: 31

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 2 bytes                          | `model`                                    | 16-bit unsigned integer            | Model number. Note that these model numbers differ from the model numbers sent in BoardInfo.
| 1 byte                           | `firmwareVersionMajor`                     | unsigned byte                      | Host firmware version (major) - as a binary number.
| 1 byte                           | `firmwareVersionMinor`                     | unsigned byte                      | Host firmware version (minor) - as a binary number.
| 8 bytes                          | `serialNumber`                             | 64-bit unsigned integer            | Host 64-bit serial number.

## `HostStatus` Data Structure

Dynamic host status to be sent by the control board side of a Z9 Lock, to the reader board.

Maximum serialized length: 5 bytes
`PacketContent` discriminator: byte: 32

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `pairingState`                             | `HostPairingState` enum            | Host pairing state.
| 1 byte                           | `tamper`                                   | boolean                            | Tamper (0 for normal, 1 for tamper).
| 1 byte                           | `lowBattery`                               | boolean                            | Low battery (0 for normal, 1 for low battery).
| 1 byte                           | `syncRequested`                            | boolean                            | Sync requested (0 for true, 1 for false)

## `ProtocolPassthru` Data Structure

Protocol passthru.  Used to pass through another protocol, opaque to this one, e.g. z9lockio.  Bidirectional.

Maximum serialized length: 1030 bytes
`PacketContent` discriminator: byte: 30

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `protocolId`                               | `ProtocolPassthruId` enum          | The protocol ID
| 1 byte                           | `numFragments`                             | byte                               | The total number of fragments the passthru message is broken into.  If not broken up (fits in one message), this value is 1.
| 1 byte                           | `fragmentIndex`                            | byte                               | The 0-based index of the fragment.
| 2 bytes                          | `numBytes`                                 | 16-bit integer                     | element count of next field - Number of passthru bytes
| Up to 1024 elements (1024 bytes) | `bytes`                                    | byte                               | Passthru bytes

## `EncryptedContent` Data Structure

Encrypted content (AES-128).  The content to be encrypted will be another subclass of PacketContent, serialized.

Maximum serialized length: 1027 bytes
`PacketContent` discriminator: byte: 35

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 2 bytes                          | `numBytes`                                 | 16-bit integer                     | element count of next field - Number of encrypted bytes, plus 12 for the the 12-byte IV, plus 16 bytes for the tag
| Up to 1024 elements (1024 bytes) | `bytes`                                    | byte                               | 12-byte IV, followed by 16-byte tag, followed by encrypted bytes

## `EncryptionKeyExchange` Data Structure

Encryption key negotiation message.  Used to establish pairing, as well as session keys.  See EncryptionKeyExchangeType for exchange flow.

Maximum serialized length: 19 bytes
`PacketContent` discriminator: byte: 36

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `type`                                     | `EncryptionKeyExchangeType` enum   | The type of key exchange
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field - Number of key bytes
| Up to 16 elements (16 bytes)     | `bytes`                                    | byte                               | key bytes, meaning/use dependent on EncryptionKeyExchangeType

## `ApplicationEncryptionKeyExchange` Data Structure

Application encryption key negotiation message.  Establishes application-level encryption keys (above the link level).  This includes cloud-lock encryption, and mobile-lock encryption.  See ApplicationEncryptionKeyExchangeType for exchange flow.

Maximum serialized length: 68 bytes
`PacketContent` discriminator: byte: 37

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `type`                                     | `ApplicationEncryptionKeyExchangeType` enum | The type of key exchange
| 1 byte                           | `numBytes`                                 | byte                               | element count of next field - Number of key/nonce bytes
| Up to 65 elements (65 bytes)     | `bytes`                                    | byte                               | key/nonce bytes

## `Packet` Data Structure

Maximum serialized length: 2061 bytes

| Size                             | Name                                       | Type                               | Description
| -------------------------------- | ------------------------------------------ | ---------------------------------- | -----------
| 1 byte                           | `headerByte`                               | byte                               | static value: always 127 - Fixed header byte, 0x7f.
| 2 bytes                          | `bytecount`                                | 16-bit integer                     | total bytecount of all bytes, including header (starting with 0x7f) and trailer (CRC16).
| 1 byte                           | `address`                                  | byte                               | address (always 0 unless multidrop is enabled).
| 1 byte                           | `seqno`                                    | byte                               | sequence number
| Up to 2054 bytes                 | `content`                                  | `PacketContent` structure          | discriminator-based structure - Content.
| 2 bytes                          | `crc16`                                    | 16-bit integer                     | CRC16.

